<!doctype html>
<html lang="en" data-bs-theme="system">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="<%= metaDescription %>" />
    <meta name="theme-color" content="#fff">
    <title>
        <%= metaTitle %>
    </title>
    <script>
        // Генерация URL для подписки
        let userData = {};
        let subscriptionUrl = window.location.href;
        try {
            const panelData = JSON.parse(atob('<%- panelData %>'));
            if (panelData && panelData.response) {
                userData = panelData.response.user || {};
                // Сохраняем subscription URL
                subscriptionUrl = panelData.response.subscriptionUrl || window.location.href;
            }
        } catch (error) {
            console.error('Error parsing panel data:', error);
        }

        // Обновляем URL для подписки
        const SUB_URL = subscriptionUrl;
        const happUrl = "happ://add/" + SUB_URL + "#Title";

        // Функция для обработки URL параметров
        function handleUrlParameters() {
            const urlParams = new URLSearchParams(window.location.search);
            const happUrlParam = urlParams.get("happ_url");
            if (happUrlParam) {
                window.location.href = happUrlParam;
            }
        }

        document.addEventListener('DOMContentLoaded', function () {
            // Обработка URL параметров
            handleUrlParameters();
        });

        function handlePowerClick() {
            const subscriptionUrl = document.getElementById('subscription-url')?.value;
            if (!subscriptionUrl) {
                showError('Ссылка подписки не найдена');
                return;
            }

            const platform = detectPlatform();
            const urlScheme = 'vmess://'; // или другие схемы в зависимости от конфигурации

            // Пытаемся открыть приложение
            window.location.href = urlScheme + subscriptionUrl;

            // Показываем модальное окно с вариантами скачивания
            setTimeout(() => {
                const modal = document.getElementById('modal');
                if (modal) {
                    modal.style.display = 'block';
                    const downloadButtons = document.getElementById('downloadButtons');
                    if (downloadButtons) {
                        downloadButtons.innerHTML = getDownloadButtons(platform);
                    }
                }
            }, 1000);
        }

        // Color mode toggler.

        const COLOR_SCHEME = '(prefers-color-scheme: dark)';

        // Defines the default website theme used when the user hasn't
        // selected a different one.
        const DEFAULT_THEME = 'system';
        // Colors for light and dark themes in the theme-color value,
        // used to change browser interface colors, like the top bar in Safari.
        const META_THEME_COLORS = { light: '#fff', dark: '#151515' };

        function getUserTheme() {
            return localStorage.getItem('theme') || DEFAULT_THEME;
        }

        function setTheme(theme) {
            if (theme === 'system') {
                theme = window.matchMedia(COLOR_SCHEME).matches ? 'dark' : 'light';
            }
            document.documentElement.setAttribute('data-bs-theme', theme);
            document
                .querySelector(`[name='theme-color']`)
                .setAttribute('content', META_THEME_COLORS[theme]);
        }

        setTheme(getUserTheme());
        window.matchMedia(COLOR_SCHEME).addEventListener('change', () => {
            if (getUserTheme() === 'system') setTheme('system');
        });

        document.addEventListener('DOMContentLoaded', () => {
            const btnTheme = document.getElementById('btn-theme');
            document.querySelectorAll('.my-dropdown-item-theme').forEach(item => {
                item.addEventListener('click', () => {
                    localStorage.setItem('theme', item.dataset.themeVal);
                    setTheme(item.dataset.themeVal);
                    showActiveDropdownItem(
                        btnTheme,
                        item,
                        document.querySelector('.my-dropdown-item-theme.active'),
                    );
                });
            });

            showActiveDropdownItem(
                btnTheme,
                document.querySelector(`[data-theme-val="${getUserTheme()}"]`),
                document.querySelector('.my-dropdown-item-theme.active'),
            );

            // Initialize Telegram WebApp
            try {
                if (window.Telegram?.WebApp) {
                    Telegram.WebApp.ready();
                    Telegram.WebApp.expand();
                }
            } catch (e) {
                console.warn('Telegram init error:', e);
            }
        })
    </script>
    <link href="https://raw.githubusercontent.com/dermv/marzbanify-template/refs/heads/main/img/apple-touch-icon.png"
        rel="apple-touch-icon" sizes="180x180">
    <link href="https://raw.githubusercontent.com/dermv/marzbanify-template/refs/heads/main/img/favicon-16x16.png"
        rel="icon" sizes="16x16" type="image/png">
    <link href="https://raw.githubusercontent.com/dermv/marzbanify-template/refs/heads/main/img/favicon-32x32.png"
        rel="icon" sizes="32x32" type="image/png">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        crossorigin="anonymous" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH">
    <style>
        @import url("https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap");

        :root {
            --bs-body-font-family: "Inter", sans-serif;
        }

        /* ========== ТЕМЫ ========== */
        [data-bs-theme='light'] {
            --bs-body-bg: #fff;
            --my-gray-color: #f6f5f4;
            --my-dark-gray-color: #eaeaea;
            --my-alpha-gray-color: rgba(50, 50, 50, .75);
            --my-alpha-dark-gray-color: rgba(0, 0, 0, .15);
            --my-emphasis-focus-shadow-rgb: 0, 0, 0;
            --my-heading-color: rgb(30, 25, 20);
            --my-content-color: rgba(0, 0, 0, .65);
            --my-dropdown-bg: #fff;
            --my-dropdown-link-hover-bg: rgba(55, 53, 47, .05);
            --my-modal-bg: #fff;
        }

        [data-bs-theme='dark'] {
            --bs-body-bg: #151515;
            --my-gray-color: #232323;
            --my-dark-gray-color: #1c1c1c;
            --my-alpha-gray-color: rgba(255, 255, 255, .5);
            --my-alpha-dark-gray-color: rgba(255, 255, 255, .15);
            --my-emphasis-focus-shadow-rgb: 255, 255, 255;
            --my-heading-color: rgb(225, 225, 225);
            --my-content-color: rgba(255, 255, 255, .55);
            --my-dropdown-bg: #2c2c2c;
            --my-dropdown-link-hover-bg: rgba(255, 255, 255, .05);
            --my-modal-bg: #232323;
        }

        /* ========== LAYOUT & SPACING ========== */
        .my-container {
            max-width: 1024px;
            padding-left: 1rem;
            padding-right: 1rem;
            padding-bottom: 1rem;
        }

        .my-navbar {
            --bs-navbar-nav-link-padding-x: .75rem;
            padding-top: 1rem;
            padding-bottom: 0rem;
        }

        .navbar-content {
            margin-top: 0.5rem;
        }

        @media (min-width: 576px) {
            .navbar-content {
                margin-top: 0;
            }
        }

        @media (max-width: 576px) {
            .my-navbar .navbar-nav {
                --bs-nav-link-padding-y: .75rem;
            }
            .my-navbar .nav-item .nav-link {
                border-top: 1px solid var(--my-alpha-dark-gray-color);
            }
            .my-navbar .dropdown-menu {
                margin-bottom: 1rem;
            }
        }

        .my-navbar .navbar-toggler {
            --bs-navbar-toggler-border-color: transparent;
            --bs-navbar-toggler-padding-x: 0;
            --bs-navbar-toggler-padding-y: 0;
        }

        .guide-heading {
            margin-top: 1rem;
            margin-bottom: 0rem;
        }

        .tab-content {
            margin-top: 2rem;
            margin-bottom: 1rem;
        }

        .bottom-controls {
            margin-top: 2rem;
            margin-bottom: 2rem;
        }

        /* ========== КОМПОНЕНТЫ ========== */
        .bi {
            fill: currentColor;
            width: 1em;
            height: 1em;
        }

        .my-text-heading {
            color: var(--my-heading-color);
        }

        .my-text-content {
            color: var(--my-content-color);
        }

        .my-step-counter {
            display: block;
            color: rgb(33, 178, 185);
            font-weight: 500;
            font-size: 2.5rem;
            user-select: none;
        }

        .my-step-counter::after {
            content: counter(step-counter);
            counter-increment: step-counter;
        }

        .my-tab-pane {
            counter-reset: step-counter 0;
        }

        /* ========== БЛОКИ КОНТЕНТА ========== */
        .my-block,
        .my-block-big {
            border-radius: var(--bs-border-radius-xl);
            background-color: var(--my-gray-color);
        }

        .my-block {
            padding: 1rem;
        }

        .my-block .bi {
            font-size: 1.5rem;
        }

        .my-block-big {
            padding: 1.5rem;
            padding-top: .75rem;
        }

        /* ========== НАВИГАЦИЯ ========== */
        .my-nav-link,
        .my-nav-outline {
            display: flex;
            align-items: center;
        }

        .my-nav-link:focus-visible,
        .my-nav-outline:focus-visible {
            border-radius: var(--bs-border-radius-lg);
            box-shadow: 0 0 0 .25rem var(--my-alpha-gray-color);
        }

        .my-nav-link .bi,
        .my-nav-outline .bi {
            margin-right: .5rem;
            font-size: 1.25rem;
        }

        .my-nav-link-text {
            margin-right: auto;
        }

        .my-nav-outline {
            --bs-nav-link-padding-x: .85rem;
            --bs-nav-link-padding-y: .25rem;
            --bs-nav-link-color: var(--my-heading-color);
            --bs-nav-link-hover-color: var(--my-heading-color);
            border: 1px solid var(--my-alpha-dark-gray-color);
            border-radius: var(--bs-border-radius-lg);
        }

        .my-nav-outline:hover,
        .my-nav-outline.show {
            background-color: var(--my-gray-color);
        }

        /* ========== DROPDOWN ========== */
        .dropdown-toggle::after {
            mask: url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3E%3Cpath d='M8.7 13.7c.4-.4 1.1-.4 1.5 0l6 6 6-6c.4-.4 1.1-.4 1.5 0s.4 1.1 0 1.5L17 21.9c-.4.4-1.1.4-1.5 0l-6.7-6.7c-.5-.6-.5-1.1-.1-1.5'/%3E%3C/svg%3E") 50% 50% / cover no-repeat;
            float: right;
            width: 1em;
            height: 1.25em;
            margin-right: -3px;
            margin-left: 3px;
            background-color: currentColor;
        }

        .my-dropdown .dropdown-menu {
            --bs-dropdown-padding-x: .25rem;
            --bs-dropdown-padding-y: .25rem;
            --bs-dropdown-spacer: 0;
            --bs-dropdown-bg: var(--my-dropdown-bg);
            --bs-dropdown-border-color: none;
            --bs-dropdown-border-radius: var(--bs-border-radius-lg);
            --bs-dropdown-link-color: var(--my-heading-color);
            --bs-dropdown-link-hover-color: var(--my-heading-color);
            --bs-dropdown-link-hover-bg: var(--my-dropdown-link-hover-bg);
            --bs-dropdown-link-active-color: var(--my-heading-color);
            --bs-dropdown-link-active-bg: var(--my-dropdown-bg);
            --bs-dropdown-item-padding-x: 1rem;
            --bs-dropdown-item-padding-y: .5rem;
            --bs-dropdown-item-border-radius: var(--bs-border-radius);
            box-shadow: 0 .25rem 1rem rgba(0, 0, 0, .175);
        }

        .my-dropdown .dropdown-item {
            display: flex;
            align-items: center;
        }

        .my-dropdown .dropdown-item span {
            margin-right: 2rem;
        }

        .my-dropdown .dropdown-item.active:hover,
        .my-dropdown .dropdown-item:hover:active {
            background-color: var(--my-dropdown-link-hover-bg);
        }

        .my-dropdown .my-dropdown-item-icon {
            margin-right: .5rem;
            color: var(--my-alpha-gray-color);
        }

        .my-dropdown .my-dropdown-item-check {
            margin-left: auto;
            color: transparent;
        }

        .my-dropdown .active .my-dropdown-item-check {
            color: var(--my-heading-color);
        }

        /* ========== КНОПКИ ========== */
        .my-btn-primary,
        .my-btn-neutral,
        .my-btn-outline {
            --bs-btn-padding-x: .85rem;
            --bs-btn-padding-y: .25rem;
            --bs-btn-color: #fff;
            --bs-btn-border-radius: var(--bs-border-radius-lg);
            --bs-btn-hover-color: #fff;
            --bs-btn-active-color: #fff;
            --bs-btn-active-border-color: transparent;
        }

        .my-btn-primary {
            --bs-btn-bg: rgb(28, 154, 160);
            --bs-btn-hover-bg: rgb(23, 130, 135);
            --bs-btn-focus-shadow-rgb: 25, 125, 225;
            --bs-btn-active-bg: rgb(18, 106, 110);
        }

        .my-btn-neutral {
            --bs-btn-bg: rgb(50, 50, 50);
            --bs-btn-hover-bg: rgb(65, 65, 65);
            --bs-btn-focus-shadow-rgb: var(--my-emphasis-focus-shadow-rgb);
            --bs-btn-active-bg: rgb(75, 75, 75);
            --bs-btn-disabled-color: #fff;
            --bs-btn-disabled-bg: rgb(50, 50, 50);
            --bs-btn-disabled-border-color: transparent;
        }

        .my-btn-outline {
            --bs-btn-color: var(--my-heading-color);
            --bs-btn-bg: transparent;
            --bs-btn-border-color: var(--my-alpha-dark-gray-color);
            --bs-btn-hover-color: var(--my-heading-color);
            --bs-btn-hover-bg: var(--my-gray-color);
            --bs-btn-hover-border-color: var(--my-alpha-dark-gray-color);
            --bs-btn-focus-shadow-rgb: var(--my-emphasis-focus-shadow-rgb);
            --bs-btn-active-color: var(--my-heading-color);
            --bs-btn-active-bg: var(--my-dark-gray-color);
            --bs-btn-active-border-color: var(--my-alpha-dark-gray-color);
        }

        /* ========== МОДАЛЬНЫЕ ОКНА ========== */
        .modal-backdrop {
            --bs-backdrop-opacity: .75;
        }

        .my-modal {
            --bs-modal-margin: 1rem;
            --bs-modal-bg: var(--my-modal-bg);
            --bs-modal-border-width: 0;
            --bs-modal-border-radius: var(--bs-border-radius-xl);
            --bs-modal-header-padding: 1.5rem 1.5rem 0;
            --bs-modal-header-border-width: 0;
        }

        @media (min-width: 576px) {
            .my-modal {
                --bs-modal-padding: 2rem;
            }
        }

        .my-modal .modal-dialog {
            max-width: 420px;
        }

        .my-modal .modal-content {
            padding-bottom: 1.5rem;
        }

        .my-get-link-modal-heading {
            margin-bottom: 2rem;
            font-size: 1.25rem;
        }

        .my-modal .my-text-content {
            margin-bottom: 2rem;
            font-size: 1.2rem;
        }

        /* ========== QR КОД ========== */
        #qr-code canvas {
            width: 100%;
            max-width: 240px;
            margin-top: .5rem;
            border-radius: var(--bs-border-radius-xl);
        }

        /* ========== АДАПТИВНОСТЬ ========== */
        @media (max-width: 320px) {
            .my-row-xs>* {
                width: 100%;
            }
        }
    </style>
</head>

<body x-data>
    <svg xmlns="http://www.w3.org/2000/svg" class="d-none">
        <!-- Icons from https://icons.getbootstrap.com -->
        <symbol id="android" viewBox="0 0 16 16">
            <path
                d="M2.76 3.061a.5.5 0 0 1 .679.2l1.283 2.352A8.9 8.9 0 0 1 8 5a8.9 8.9 0 0 1 3.278.613l1.283-2.352a.5.5 0 1 1 .878.478l-1.252 2.295C14.475 7.266 16 9.477 16 12H0c0-2.523 1.525-4.734 3.813-5.966L2.56 3.74a.5.5 0 0 1 .2-.678ZM5 10a1 1 0 1 0 0-2 1 1 0 0 0 0 2m6 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2" />
        </symbol>
        <symbol id="apple" viewBox="0 0 16 16">
            <path
                d="M11.182.008C11.148-.03 9.923.023 8.857 1.18c-1.066 1.156-.902 2.482-.878 2.516s1.52.087 2.475-1.258.762-2.391.728-2.43m3.314 11.733c-.048-.096-2.325-1.234-2.113-3.422s1.675-2.789 1.698-2.854-.597-.79-1.254-1.157a3.7 3.7 0 0 0-1.563-.434c-.108-.003-.483-.095-1.254.116-.508.139-1.653.589-1.968.607-.316.018-1.256-.522-2.267-.665-.647-.125-1.333.131-1.824.328-.49.196-1.422.754-2.074 2.237-.652 1.482-.311 3.83-.067 4.56s.625 1.924 1.273 2.796c.576.984 1.34 1.667 1.659 1.899s1.219.386 1.843.067c.502-.308 1.408-.485 1.766-.472.357.013 1.061.154 1.782.539.571.197 1.111.115 1.652-.105.541-.221 1.324-1.059 2.238-2.758q.52-1.185.473-1.282" />
        </symbol>
        <symbol id="mac-os" viewBox="0 0 16 16">
            <path
                d="M11.182.008C11.148-.03 9.923.023 8.857 1.18c-1.066 1.156-.902 2.482-.878 2.516s1.52.087 2.475-1.258.762-2.391.728-2.43m3.314 11.733c-.048-.096-2.325-1.234-2.113-3.422s1.675-2.789 1.698-2.854-.597-.79-1.254-1.157a3.7 3.7 0 0 0-1.563-.434c-.108-.003-.483-.095-1.254.116-.508.139-1.653.589-1.968.607-.316.018-1.256-.522-2.267-.665-.647-.125-1.333.131-1.824.328-.49.196-1.422.754-2.074 2.237-.652 1.482-.311 3.83-.067 4.56s.625 1.924 1.273 2.796c.576.984 1.34 1.667 1.659 1.899s1.219.386 1.843.067c.502-.308 1.408-.485 1.766-.472.357.013 1.061.154 1.782.539.571.197 1.111.115 1.652-.105.541-.221 1.324-1.059 2.238-2.758q.52-1.185.473-1.282" />
        </symbol>        
        <symbol id="check-lg" viewBox="0 0 16 16">
            <path
                d="M12.736 3.97a.733.733 0 0 1 1.047 0c.286.289.29.756.01 1.05L7.88 12.01a.733.733 0 0 1-1.065.02L3.217 8.384a.757.757 0 0 1 0-1.06.733.733 0 0 1 1.047 0l3.052 3.093 5.4-6.425z" />
        </symbol>
        <symbol id="circle-half" viewBox="0 0 16 16">
            <path d="M8 15A7 7 0 1 0 8 1zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16" />
        </symbol>
        <symbol id="moon-stars-fill" viewBox="0 0 16 16">
            <path
                d="M6 .278a.77.77 0 0 1 .08.858 7.2 7.2 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277q.792-.001 1.533-.16a.79.79 0 0 1 .81.316.73.73 0 0 1-.031.893A8.35 8.35 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.75.75 0 0 1 6 .278" />
            <path
                d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.73 1.73 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.73 1.73 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.73 1.73 0 0 0 1.097-1.097zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.16 1.16 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.16 1.16 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732z" />
        </symbol>
        <symbol id="pc-display" viewBox="0 0 16 16">
            <path
                d="M6.555 1.375 0 2.237v5.45h6.555zM0 13.795l6.555.933V8.313H0zm7.278-5.4.026 6.378L16 16V8.395zM16 0 7.33 1.244v6.414H16z" />
        </symbol>
        <symbol id="tv-display" viewBox="0 0 16 16">
            <path
                d="M2.76 3.061a.5.5 0 0 1 .679.2l1.283 2.352A8.9 8.9 0 0 1 8 5a8.9 8.9 0 0 1 3.278.613l1.283-2.352a.5.5 0 1 1 .878.478l-1.252 2.295C14.475 7.266 16 9.477 16 12H0c0-2.523 1.525-4.734 3.813-5.966L2.56 3.74a.5.5 0 0 1 .2-.678ZM5 10a1 1 0 1 0 0-2 1 1 0 0 0 0 2m6 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2" />
        </symbol>
        <symbol id="sun-fill" viewBox="0 0 16 16">
            <path
                d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8M8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0m0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13m8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5M3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8m10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0m-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0m9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707M4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708" />
        </symbol>
        <symbol id="translate" viewBox="0 0 16 16">
            <path
                d="M4.545 6.714 4.11 8H3l1.862-5h1.284L8 8H6.833l-.435-1.286zm1.634-.736L5.5 3.956h-.049l-.679 2.022z" />
            <path
                d="M0 2a2 2 0 0 1 2-2h7a2 2 0 0 1 2 2v3h3a2 2 0 0 1 2 2v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-3H2a2 2 0 0 1-2-2zm2-1a1 1 0 0 0-1 1v7a1 1 0 0 0 1 1h7a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1zm7.138 9.995q.289.451.63.846c-.748.575-1.673 1.001-2.768 1.292.178.217.451.635.555.867 1.125-.359 2.08-.844 2.886-1.494.777.665 1.739 1.165 2.93 1.472.133-.254.414-.673.629-.89-1.125-.253-2.057-.694-2.82-1.284.681-.747 1.222-1.651 1.621-2.757H14V8h-3v1.047h.765c-.318.844-.74 1.546-1.272 2.13a6 6 0 0 1-.415-.492 2 2 0 0 1-.94.31" />
        </symbol>
    </svg>
<header class="navbar my-navbar navbar-expand-sm" x-data>
    <div class="container my-container px-3">
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
            data-bs-target="#navbar-collapse-content" aria-controls="navbar-collapse-content" aria-expanded="false"
            aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="navbar-collapse collapse navbar-content" id="navbar-collapse-content">
            <ul class="navbar-nav me-auto">
                <li class="nav-item">
                    <a class="nav-link my-nav-link" href="https://t.me/surf_vpn_1" rel="noopener noreferrer"
                        target="_blank" x-text="$t('support')"></a>
                </li>
                <li class="nav-item dropdown my-dropdown">
                    <a class="nav-link my-nav-link dropdown-toggle" id="btn-theme" role="button"
                        data-bs-toggle="dropdown" tabindex="0" aria-expanded="false">
                        <svg class="bi my-nav-link-icon">
                            <use href="#circle-half"></use>
                        </svg>
                        <span class="my-nav-link-text" x-text="$t('system')"></span>
                    </a>
                    <ul class="dropdown-menu">
                        <li>
                            <button class="dropdown-item my-dropdown-item-theme active" type="button"
                                data-theme-val="system" aria-pressed="true">
                                <svg class="bi my-dropdown-item-icon">
                                    <use href="#circle-half"></use>
                                </svg>
                                <span x-text="$t('system')"></span>
                                <svg class="bi my-dropdown-item-check">
                                    <use href="#check-lg"></use>
                                </svg>
                            </button>
                        </li>
                        <li>
                            <button class="dropdown-item my-dropdown-item-theme" type="button"
                                data-theme-val="light" aria-pressed="false">
                                <svg class="bi my-dropdown-item-icon">
                                    <use href="#sun-fill"></use>
                                </svg>
                                <span x-text="$t('light')"></span>
                                <svg class="bi my-dropdown-item-check">
                                    <use href="#check-lg"></use>
                                </svg>
                            </button>
                        </li>
                        <li>
                            <button class="dropdown-item my-dropdown-item-theme" type="button" data-theme-val="dark"
                                aria-pressed="false">
                                <svg class="bi my-dropdown-item-icon">
                                    <use href="#moon-stars-fill"></use>
                                </svg>
                                <span x-text="$t('dark')"></span>
                                <svg class="bi my-dropdown-item-check">
                                    <use href="#check-lg"></use>
                                </svg>
                            </button>
                        </li>
                    </ul>
                </li>
                <li class="nav-item dropdown my-dropdown" x-data>
                    <a class="nav-link my-nav-link dropdown-toggle" id="btn-lang" role="button"
                        data-bs-toggle="dropdown" tabindex="0" aria-expanded="false">
                        <svg class="bi">
                            <use href="#translate"></use>
                        </svg>
                        <span class="my-nav-link-text">English</span>
                    </a>
                    <ul class="dropdown-menu">
                        <li>
                            <button class="dropdown-item my-dropdown-item-lang active" type="button"
                                data-locale="en" aria-pressed="true">
                                <span>English</span>
                                <svg class="bi my-dropdown-item-check">
                                    <use href="#check-lg"></use>
                                </svg>
                            </button>
                        </li>
                        <li>
                            <button class="dropdown-item my-dropdown-item-lang" type="button" data-locale="ru"
                                aria-pressed="false">
                                <span>Русский</span>
                                <svg class="bi my-dropdown-item-check">
                                    <use href="#check-lg"></use>
                                </svg>
                            </button>
                        </li>
                    </ul>
                </li>
            </ul>
        </div>
        <div class="dropdown my-dropdown ms-auto">
            <button class="nav-link my-nav-outline dropdown-toggle" id="btn-guide" type="button"
                data-bs-toggle="dropdown">
                <svg class="bi my-nav-link-icon">
                    <use href="#android"></use>
                </svg>
                <span class="my-nav-link-text"></span>
            </button>
            <ul class="dropdown-menu dropdown-menu-end" role="tablist">
                <li>
                    <button class="dropdown-item my-dropdown-item-guide" id="btn-guide-ios-tab" type="button"
                        data-bs-target="#tab-ios" data-bs-toggle="tab" role="tab" aria-controls="tab-ios"
                        aria-selected="false">
                        <svg class="bi my-dropdown-item-icon">
                            <use href="#apple"></use>
                        </svg>
                        <span>iOS</span>
                        <svg class="bi my-dropdown-item-check">
                            <use href="#check-lg"></use>
                        </svg>
                    </button>
                </li>
                <li>
                    <button class="dropdown-item my-dropdown-item-guide active" id="btn-guide-android-tab"
                        type="button" data-bs-target="#tab-android" data-bs-toggle="tab" role="tab"
                        aria-controls="tab-android" aria-selected="true">
                        <svg class="bi my-dropdown-item-icon">
                            <use href="#android"></use>
                        </svg>
                        <span>Android</span>
                        <svg class="bi my-dropdown-item-check">
                            <use href="#check-lg"></use>
                        </svg>
                    </button>
                </li>
                <li>
                    <button class="dropdown-item my-dropdown-item-guide" id="btn-guide-macos-tab" type="button"
                        data-bs-target="#tab-macos" data-bs-toggle="tab" role="tab" aria-controls="tab-macos"
                        aria-selected="false">
                        <svg class="bi my-dropdown-item-icon">
                            <use href="#apple"></use>
                        </svg>
                        <span x-text="$t('macos')"></span>
                        <svg class="bi my-dropdown-item-check">
                            <use href="#check-lg"></use>
                        </svg>
                    </button>
                </li>
                <li>
                    <button class="dropdown-item my-dropdown-item-guide" id="btn-guide-pc-tab" type="button"
                        data-bs-target="#tab-pc" data-bs-toggle="tab" role="tab" aria-controls="tab-pc"
                        aria-selected="false">
                        <svg class="bi my-dropdown-item-icon">
                            <use href="#pc-display"></use>
                        </svg>
                        <span x-text="$t('pc')"></span>
                        <svg class="bi my-dropdown-item-check">
                            <use href="#check-lg"></use>
                        </svg>
                    </button>
                </li>
                <li>
                    <button class="dropdown-item my-dropdown-item-guide" id="btn-guide-tv-tab" type="button"
                        data-bs-target="#tab-tv" data-bs-toggle="tab" role="tab" aria-controls="tab-tv"
                        aria-selected="false">
                        <svg class="bi my-dropdown-item-icon">
                            <use href="#tv-display"></use>
                        </svg>
                        <span x-text="$t('tv')"></span>
                        <svg class="bi my-dropdown-item-check">
                            <use href="#check-lg"></use>
                        </svg>
                    </button>
                </li>
            </ul>
        </div>
    </div>
</header>
    <div class="container my-container px-3 pb-3" x-data>
        <h4 class="my-text-heading fw-bold guide-heading" x-text="$t('guide')"></h4>
        <div class="tab-content" role="tablist">
            <div id="tab-android" class="tab-pane my-tab-pane fade show active" aria-labelledby="btn-guide-android-tab"
                role="tabpanel">
                <div class="row row-cols-1 row-cols-sm-2 row-cols-lg-3 g-3">
                    <div class="col">
                        <div class="my-block-big h-100">
                            <span class="my-step-counter mb-1"></span>
                            <h5 class="my-text-heading fw-semibold" x-text="$t('guideContent.android.first.title')">
                            </h5>
                            <p class="my-text-content" x-html="$t('guideContent.android.first.text')"></p>
                            <div class="d-flex flex-wrap gap-2">
                                <a class="btn my-btn-primary"
                                    href="https://play.google.com/store/apps/details?id=com.happproxy"
                                    role="button" rel="noopener noreferrer" target="_blank">
                                    <span class="fw-semibold" x-text="$t('downloadApp')"></span>
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="col">
                        <div class="my-block-big h-100">
                            <span class="my-step-counter mb-1"></span>
                            <h5 class="my-text-heading fw-semibold" x-text="$t('guideContent.android.second.title')">
                            </h5>
                            <p class="my-text-content" x-html="$t('guideContent.android.second.text')"></p>
                            <div class="d-flex flex-wrap gap-2">
                                <a class="btn my-btn-primary"
                                    href="https://github.com/Happ-proxy/happ-android/releases/latest/download/Happ.apk" role="button"
                                    rel="noopener noreferrer" target="_blank">
                                    <span class="fw-semibold" x-text="$t('downloadApp')"></span>
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="col">
                        <div class="my-block-big h-100">
                            <span class="my-step-counter mb-1"></span>
                            <h5 class="my-text-heading fw-semibold" x-text="$t('guideContent.android.third.title')">
                            </h5>
                            <p class="my-text-content" x-html="$t('guideContent.android.third.text')"></p>
                            <a class="btn my-btn-primary fw-semibold" id="sub-url-android" role="button"
                                rel="noopener noreferrer" target="_blank" x-text="$t('addSubscription')"></a>
                        </div>
                    </div>
                    <div class="col">
                        <div class="my-block-big h-100">
                            <span class="my-step-counter mb-1"></span>
                            <h5 class="my-text-heading fw-semibold" x-text="$t('guideContent.android.fourth.title')">
                            </h5>
                            <p class="my-text-content mb-0" x-html="$t('guideContent.android.fourth.text')"></p>
                        </div>
                    </div>
                    <div class="col">
                        <div class="my-block-big h-100">
                            <span class="my-step-counter mb-1"></span>
                            <h5 class="my-text-heading fw-semibold" x-text="$t('guideContent.android.fifth.title')">
                            </h5>
                            <p class="my-text-content mb-0" x-html="$t('guideContent.android.fifth.text')"></p>
                        </div>
                    </div>
                </div>
            </div>
            <div id="tab-ios" class="tab-pane my-tab-pane fade" aria-labelledby="btn-guide-ios-tab" role="tabpanel">
                <div class="row row-cols-1 row-cols-sm-2 row-cols-lg-3 g-3">
                    <div class="col">
                        <div class="my-block-big h-100">
                            <span class="my-step-counter mb-1"></span>
                            <h5 class="my-text-heading fw-semibold" x-text="$t('guideContent.ios.first.title')"></h5>
                            <p class="my-text-content" x-html="$t('guideContent.ios.first.text')"></p>
                            <a class="btn my-btn-primary" href="https://apps.apple.com/ru/app/happ-proxy-utility-plus/id6746188973"
                                role="button" rel="noopener noreferrer" target="_blank">
                                <span class="fw-semibold" x-text="$t('downloadApp')"></span>
                            </a>
                        </div>
                    </div>
                    <div class="col">
                        <div class="my-block-big h-100">
                            <span class="my-step-counter mb-1"></span>
                            <h5 class="my-text-heading fw-semibold" x-text="$t('guideContent.ios.second.title')"></h5>
                            <p class="my-text-content" x-html="$t('guideContent.ios.second.text')"></p>
                            <a class="btn my-btn-primary fw-semibold" id="sub-url-ios" role="button"
                                rel="noopener noreferrer" target="_blank" x-text="$t('addSubscription')"></a>
                        </div>
                    </div>
                    <div class="col">
                        <div class="my-block-big h-100">
                            <span class="my-step-counter mb-1"></span>
                            <h5 class="my-text-heading fw-semibold" x-text="$t('guideContent.ios.third.title')"></h5>
                            <p class="my-text-content mb-0" x-html="$t('guideContent.ios.third.text')"></p>
                        </div>
                    </div>
                    <div class="col">
                        <div class="my-block-big h-100">
                            <span class="my-step-counter mb-1"></span>
                            <h5 class="my-text-heading fw-semibold" x-text="$t('guideContent.ios.fourth.title')"></h5>
                            <p class="my-text-content mb-0" x-html="$t('guideContent.ios.fourth.text')"></p>
                        </div>
                    </div>
                </div>
            </div>
            <div id="tab-pc" class="tab-pane my-tab-pane fade" aria-labelledby="btn-guide-pc-tab" role="tabpanel">
                <div class="row row-cols-1 row-cols-sm-2 row-cols-lg-3 g-3">
                    <div class="col">
                        <div class="my-block-big h-100">
                            <span class="my-step-counter mb-1"></span>
                            <h5 class="my-text-heading fw-semibold" x-text="$t('guideContent.pc.first.title')"></h5>
                            <p class="my-text-content" x-html="$t('guideContent.pc.first.text')"></p>
                            <div class="d-flex flex-wrap gap-2">
                                <a class="btn my-btn-primary"
                                    href="https://github.com/Happ-proxy/happ-desktop/releases/latest/download/setup-Happ.x86.exe"
                                    role="button" rel="noopener noreferrer" target="_blank">
                                    <span class="fw-semibold" x-text="$t('downloadApp')"></span>
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="col">
                        <div class="my-block-big h-100">
                            <span class="my-step-counter mb-1"></span>
                            <h5 class="my-text-heading fw-semibold" x-text="$t('guideContent.pc.second.title')"></h5>
                            <p class="my-text-content" x-html="$t('guideContent.pc.second.text')"></p>
                            <a class="btn my-btn-primary fw-semibold" id="sub-url-pc" role="button"
                                rel="noopener noreferrer" target="_blank" x-text="$t('addSubscription')"></a>
                        </div>
                    </div>
                    <div class="col">
                        <div class="my-block-big h-100">
                            <span class="my-step-counter mb-1"></span>
                            <h5 class="my-text-heading fw-semibold" x-text="$t('guideContent.pc.third.title')"></h5>
                            <p class="my-text-content mb-0" x-html="$t('guideContent.pc.third.text')"></p>

                        </div>
                    </div>
                </div>
            </div>
            <div id="tab-tv" class="tab-pane my-tab-pane fade" aria-labelledby="btn-guide-tv-tab"
                role="tabpanel">
                <div class="row row-cols-1 row-cols-sm-2 row-cols-lg-3 g-3">
                    <div class="col">
                        <div class="my-block-big h-100">
                            <span class="my-step-counter mb-1"></span>
                            <h5 class="my-text-heading fw-semibold" x-text="$t('guideContent.tv.first.title')">
                            </h5>
                            <p class="my-text-content" x-html="$t('guideContent.tv.first.text')"></p>
                        </div>
                    </div>
                    <div class="col">
                        <div class="my-block-big h-100">
                            <span class="my-step-counter mb-1"></span>
                            <h5 class="my-text-heading fw-semibold" x-text="$t('guideContent.tv.second.title')">
                            </h5>
                            <p class="my-text-content" x-html="$t('guideContent.tv.second.text')"></p>
                        </div>
                    </div>
                    <div class="col">
                        <div class="my-block-big h-100">
                            <span class="my-step-counter mb-1"></span>
                            <h5 class="my-text-heading fw-semibold" x-text="$t('guideContent.tv.third.title')">
                            </h5>
                            <p class="my-text-content" x-html="$t('guideContent.tv.third.text')"></p>
                        </div>
                    </div>
                    <div class="col">
                        <div class="my-block-big h-100">
                            <span class="my-step-counter mb-1"></span>
                            <h5 class="my-text-heading fw-semibold" x-text="$t('guideContent.tv.fourth.title')">
                            </h5>
                            <p class="my-text-content mb-0" x-html="$t('guideContent.tv.fourth.text')"></p>
                        </div>
                    </div>
                    <div class="col">
                        <div class="my-block-big h-100">
                            <span class="my-step-counter mb-1"></span>
                            <h5 class="my-text-heading fw-semibold" x-text="$t('guideContent.tv.fifth.title')">
                            </h5>
                            <p class="my-text-content mb-0" x-html="$t('guideContent.tv.fifth.text')"></p>
                        </div>
                    </div>
                </div>
            </div>
            <div id="tab-macos" class="tab-pane my-tab-pane fade" aria-labelledby="btn-guide-macos-tab" role="tabpanel">
                <div class="row row-cols-1 row-cols-sm-2 row-cols-lg-3 g-3">
                    <div class="col">
                        <div class="my-block-big h-100">
                            <span class="my-step-counter mb-1"></span>
                            <h5 class="my-text-heading fw-semibold" x-text="$t('guideContent.macos.first.title')"></h5>
                            <p class="my-text-content" x-html="$t('guideContent.macos.first.text')"></p>
                            <div class="d-flex flex-wrap gap-2">
                                <a class="btn my-btn-primary"
                                    href="https://github.com/Happ-proxy/happ-desktop/releases/download/alpha_0.0.24/Happ.macOS.arm64.app.tar.gz"
                                    role="button" rel="noopener noreferrer" target="_blank">
                                    <span class="fw-semibold" x-text="$t('macosm')"></span>
                                </a>
                                <a class="btn my-btn-primary"
                                    href="https://github.com/Happ-proxy/happ-desktop/releases/download/alpha_0.0.24/Happ.macOS.x86_64.app.tar.gz"
                                    role="button" rel="noopener noreferrer" target="_blank">
                                    <span class="fw-semibold" x-text="$t('macosintel')"></span>
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="col">
                        <div class="my-block-big h-100">
                            <span class="my-step-counter mb-1"></span>
                            <h5 class="my-text-heading fw-semibold" x-text="$t('guideContent.macos.second.title')"></h5>
                            <p class="my-text-content" x-html="$t('guideContent.macos.second.text')"></p>
                            <div class="d-flex flex-wrap gap-2">
                                <a class="btn my-btn-primary"
                                    href="https://support.apple.com/ru-ru/guide/mac-help/mchleab3a043/mac"
                                    role="button" rel="noopener noreferrer" target="_blank">
                                    <span class="fw-semibold" x-text="$t('macosInstr')"></span>
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="col">
                        <div class="my-block-big h-100">
                            <span class="my-step-counter mb-1"></span>
                            <h5 class="my-text-heading fw-semibold" x-text="$t('guideContent.macos.third.title')"></h5>
                            <p class="my-text-content" x-html="$t('guideContent.macos.third.text')"></p>
                            <a class="btn my-btn-primary fw-semibold" id="sub-url-macos" role="button"
                                rel="noopener noreferrer" target="_blank" x-text="$t('addSubscription')"></a>
                        </div>
                    </div>
                    <div class="col">
                        <div class="my-block-big h-100">
                            <span class="my-step-counter mb-1"></span>
                            <h5 class="my-text-heading fw-semibold" x-text="$t('guideContent.macos.fourth.title')"></h5>
                            <p class="my-text-content mb-0" x-html="$t('guideContent.macos.fourth.text')"></p>
                        </div>
                    </div>
                    <div class="col">
                        <div class="my-block-big h-100">
                            <span class="my-step-counter mb-1"></span>
                            <h5 class="my-text-heading fw-semibold" x-text="$t('guideContent.macos.fifth.title')"></h5>
                            <p class="my-text-content mb-0" x-html="$t('guideContent.macos.fifth.text')"></p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="d-flex flex-wrap align-items-center justify-content-center gap-2 bottom-controls">
            <button class="btn my-btn-outline" data-bs-toggle="modal" data-bs-target="#get-link-modal"
                x-text="$t('getLink')"></button>
            <div class="modal my-modal fade" id="get-link-modal" tabindex="-1">
                <div class="modal-dialog modal-dialog-centered">
                    <div class="modal-content">
                        <div class="modal-header">
                            <button type="button" class="btn-close my-btn-close" data-bs-dismiss="modal"
                                aria-label="Close"></button>
                        </div>
                        <div class="modal-body text-center" x-data="copyLink">
                            <div class="mb-4" id="qr-code"></div>
                            <p class="my-text-content" x-text="$t('getLinkModalSubtitle')"></p>
                            <button class="btn my-btn-neutral" @click="copyToClipboard" :disabled="isDisabled"
                                x-text="isDisabled ? $t('copied') : $t('copyLink')"></button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"></script>
    <script src="https://cdn.jsdelivr.net/npm/alpinejs-i18n@2.x.x/dist/cdn.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
    <script src="https://unpkg.com/qr-code-styling@1.9.1/lib/qr-code-styling.js"></script>
    <script>
        const SUB_URL_SCHEMES = {
            pc: `happ://add/${window.subscriptionUrl}#${userData.username || 'user'}`,
            android: `happ://add/${window.subscriptionUrl}#${userData.username || 'user'}`,
            ios: `happ://add/${window.subscriptionUrl}#${userData.username || 'user'}`,
            macos: `happ://add/${window.subscriptionUrl}#${userData.username || 'user'}`,
        };
        // Default locale used to display content if
        // the user's locale is not specified.
        const DEFAULT_LOCALE = 'en';
        // Translation data.
        const MESSAGES = {
            en: {
                support: 'Support',
                system: 'System',
                light: 'Light',
                dark: 'Dark',
                getLink: 'Get link',
                getLinkModalSubtitle: 'Add a subscription to the app by scanning the QR code, or copy the link by clicking the button below and add it to the app',
                copyLink: 'Copy link',
                copied: 'Copied',
                guide: 'Follow instructions:',
                pc: 'Windows',
                macos: 'MacOS',
                macosm: 'M Series',
                macosintel: 'Intel Series',
                tv: 'Android TV',
                downloadApp: 'Download',
                macosInstr: 'View',
                addSubscription: 'Add subscription',
                guideContent: {
                    pc: {
                        first: {
                            title: 'Download app',
                            text: `Click on the button below to download the app. Install and run it.`,
                        },
                        second: {
                            title: 'Add subscription',
                            text: `Click the button below to add the subscription to the app. In the pop-up window, select <b>«Open the "Happ, xray GUI client application".»</b>.`,
                        },
                        third: {
                            title: 'Enable VPN',
                            text: `Click the big round button to enable VPN.`,
                        },
                    },
                    android: {
                        first: {
                            title: 'Download app',
                            text: `Click on the button below to download the app.`,
                        },
                        second: {
                            title: 'Unable to download?',
                            text: `Click the button below to download the app from another source and install it manually.`,
                        },
                        third: {
                            title: 'Add subscription',
                            text: `Click the button below to add the subscription to the app.`,
                        },
                        fourth: {
                            title: 'Unable to add?',
                            text: `Click <b>«Get link»</b> at the end of the page and select <b>«Copy link»</b>. Open the installed application and click <b>«Paste»</b>.`,
                        },
                        fifth: {
                            title: 'Enable VPN',
                            text: `Click the big round button to enable VPN.`,
                        },
                    },
                    ios: {
                        first: {
                            title: 'Download app',
                            text: `Click on the button below to download the app.`,
                        },
                        second: {
                            title: 'Add subscription',
                            text: `Click the button below to add the subscription to the app.`,
                        },
                        third: {
                            title: 'Enable VPN',
                            text: `Click the big round button to enable VPN.`,
                        },
                        fourth: {
                            title: 'Not working?',
                            text: `Restart your phone and reconnect.`,
                        },
                    },
                    tv: {
                        first: {
                            title: 'Important!',
                            text: `<b>-</b> Make sure that our VPN is already installed on your phone.<br><b>-</b> The TV and your phone are connected to the same Wi-Fi network.`,
                        },
                        second: {
                            title: 'Install app',
                            text: `On your TV, open <b>«Google Play»</b>, install the <b>«Happ»</b> app and launch it.`,
                        },
                        third: {
                            title: 'Scan QR code',
                            text: `On your phone, open the <b>«Happ» app</b>, press <b>«+»</b>, select <b>«QR Code»</b> and scan it from TV.`,
                        },
                        fourth: {
                            title: 'Add subscription',
                            text: `Check box next to <b>«Subscription»</b> and click <b>«Send»</b>.`,
                        },
                        fifth: {
                            title: 'Enable VPN',
                            text: `Click the big round button to enable VPN.`,
                        },
                    },
                    macos: {
                        first: {
                            title: 'Download app',
                            text: `Click the button below to download the app for your processor. Unzip the file, open it and move the app to <b>«Applications»</b>.`,
                        },
                        second: {
                            title: 'Unable to open?',
                            text: `Click the button below to view instructions for launching third-party apps.`,
                        },
                        third: {
                            title: 'Add subscription',
                            text: `Click the button below to add the subscription to the app.`,
                        },
                        fourth: {
                            title: 'Unable to add?',
                            text: `- Click <b>«Get link»</b> at the end of the page and select <b>«Copy link»</b>.<br>- Open the installed app, insert the link in the <b>«Subscription or VLESS...»</b> field and click <b>«Get started»</b>.`,
                        },
                        fifth: {
                            title: 'Enable VPN',
                            text: `Click the big round button to enable VPN.`,
                        },
                    },
                },
            },
            ru: {
                support: 'Поддержка',
                system: 'Системная',
                light: 'Светлая',
                dark: 'Темная',
                getLink: 'Получить ссылку',
                getLinkModalSubtitle: 'Добавьте подписку в приложение, отсканировав QR-код, или скопируйте ссылку, нажав кнопку ниже, и добавьте её в приложение',
                copyLink: 'Скопировать ссылку',
                copied: 'Скопировано',
                guide: 'Следуйте инструкции:',
                pc: 'Windows',
                macos: 'MacOS',
                macosm: 'Серия M',
                macosintel: 'Серия Intel',
                tv: 'Android TV',
                downloadApp: 'Скачать',
                macosInstr: 'Перейти',
                addSubscription: 'Добавить',
                guideContent: {
                    pc: {
                        first: {
                            title: 'Скачайте приложение',
                            text: `Нажмите кнопку ниже, чтобы скачать приложение. Установите и запустите его.`,
                        },
                        second: {
                            title: 'Добавьте подписку',
                            text: `Нажмите кнопку ниже, чтобы добавить подписку в приложение. Во всплывающем окне выберите <b>«Открыть приложение "Happ, xray GUI client".»</b>.`,
                        },
                        third: {
                            title: 'Включите VPN',
                            text: `Нажмите большую круглую кнопку, чтобы включить VPN.`,
                        },
                    },
                    android: {
                        first: {
                            title: 'Скачайте приложение',
                            text: `Нажмите кнопку ниже, чтобы скачать приложение.`,
                        },
                        second: {
                            title: 'Не удалось скачать?',
                            text: `Нажмите кнопку ниже, чтобы скачать приложение из другого источника и установите его вручную.`,
                        },
                        third: {
                            title: 'Добавьте подписку',
                            text: `Нажмите кнопку ниже, чтобы добавить подписку в приложение.`,
                        },
                        fourth: {
                            title: 'Не удалось добавить?',
                            text: `Нажмите <b>«Получить ссылку»</b> в конце страницы и выберите <b>«Скопировать ссылку»</b>. Откройте установленное приложение и нажмите <b>«Вставить»</b>.`,
                        },
                        fifth: {
                            title: 'Включите VPN',
                            text: `Нажмите большую круглую кнопку, чтобы включить VPN.`,
                        },
                    },
                    ios: {
                        first: {
                            title: 'Скачайте приложение',
                            text: `Нажмите кнопку ниже, чтобы скачать приложение.`,
                        },
                        second: {
                            title: 'Добавьте подписку',
                            text: `Нажмите кнопку ниже, чтобы добавить подписку в приложение.`,
                        },
                        third: {
                            title: 'Включите VPN',
                            text: `Нажмите большую круглую кнопку, чтобы включить VPN.`,
                        },
                        fourth: {
                            title: 'Не работает?',
                            text: `Перезагрузите телефон и подключитесь снова.`,
                        },
                    },
                    tv: {
                        first: {
                            title: 'Важно!',
                            text: `<b>-</b> Убедитесь, что наш VPN уже установлен на вашем телефоне.<br><b>-</b> Телевизор и телефон подключены к одной сети Wi-Fi.`,
                        },
                        second: {
                            title: 'Установите приложение',
                            text: `На телевизоре откройте <b>«Google Play»</b>, установите приложение <b>«Happ»</b> и запустите его.`,
                        },
                        third: {
                            title: 'Отсканируйте QR-код',
                            text: `На телефоне откройте приложение <b>«Happ»</b>, нажмите <b>«+»</b>, выберите <b>«QR-код»</b> и отсканируйте его с телевизора.`,
                        },
                        fourth: {
                            title: 'Добавьте подписку',
                            text: `Установите галочку напротив <b>«Subscription»</b> и нажмите <b>«Отправить»</b>.`,
                        },
                        fifth: {
                            title: 'Включите VPN',
                            text: `Нажмите большую круглую кнопку, чтобы включить VPN.`,
                        },
                    },
                    macos: {
                        first: {
                            title: 'Скачайте приложение',
                            text: `Нажмите кнопку ниже, чтобы скачать приложение под ваш процессор. Распакуйте файл, откройте его и переместите приложение в <b>«Программы»</b>.`,
                        },
                        second: {
                            title: 'Не удалось открыть?',
                            text: `Нажмите кнопку ниже, чтобы перейти к инструкции о запуске приложений от сторонних разработчиков.`,
                        },
                        third: {
                            title: 'Добавьте подписку',
                            text: `Нажмите кнопку ниже, чтобы добавить подписку в приложение.`,
                        },
                        fourth: {
                            title: 'Не удалось добавить?',
                            text: `- Нажмите <b>«Получить ссылку»</b> в конце страницы и выберите <b>«Скопировать ссылку»</b>.<br>- Откройте установленное приложение, вставьте ссылку в поле <b>«Subscription or VLESS...»</b> и нажмите <b>«Get started»</b>.`,
                        },
                        fifth: {
                            title: 'Включите VPN',
                            text: `Нажмите большую круглую кнопку, чтобы включить VPN.`,
                        },
                    },
                },
            },
        };

        function getTabIdByDevice() {
            const userAgent = navigator.userAgent.toLowerCase();
            if (userAgent.includes('android')) {
                return '#tab-android';
            } else if (userAgent.includes('iphone') || userAgent.includes('ipad')) {
                return '#tab-ios';
            } else if (userAgent.includes('mac os x') || userAgent.includes('macintosh')) {
                return '#tab-macos';
            } else {
                return '#tab-pc';
            }
        }

        function getUserLocale() {
            // Проверка параметра lang в URL
            const urlParams = new URLSearchParams(window.location.search);
            const urlLang = urlParams.get('lang');
            if (urlLang === 'en' || urlLang === 'ru') return urlLang;

            // Проверка языка из Telegram
            try {
                const tgLang = window.Telegram?.WebApp?.initDataUnsafe?.user?.language_code;
                if (tgLang) return tgLang.startsWith('ru') ? 'ru' : 'en';
            } catch (e) {
                console.warn('Telegram error:', e);
            }

            // Проверка localStorage
            const storedLocale = localStorage.getItem('locale');
            if (storedLocale && storedLocale in MESSAGES) return storedLocale;

            // Проверка браузера
            const browserLang = (navigator.language || navigator.userLanguage || 'en').toLowerCase();
            const russianLanguageCodes = ['ru', 'ru-ru', 'ru_ru', 'by', 'kz', 'kg', 'uz'];
            return russianLanguageCodes.some(code => browserLang.includes(code)) ? 'ru' : 'en';
        }

        function showActiveDropdownItem(btn, newItem, prevItem) {
            if (prevItem) {
                bootstrap.Button.getOrCreateInstance(prevItem).toggle();
                bootstrap.Button.getOrCreateInstance(newItem).toggle();
            }

            const btnIcon = btn.querySelector('.my-nav-link-icon use');
            const newItemIcon = newItem.querySelector('.my-dropdown-item-icon use');
            if (btnIcon && newItemIcon) {
                btnIcon.setAttribute('href', newItemIcon.getAttribute('href'));
            }

            const btnText = btn.querySelector('.my-nav-link-text');
            const newItemText = newItem.querySelector('span');
            if (btnText && newItemText) {
                btnText.innerHTML = newItemText.outerHTML;
            }
        }

        document.addEventListener('alpine-i18n:ready', () => {
            window.AlpineI18n.fallbackLocale = 'en';
            window.AlpineI18n.create(getUserLocale(), MESSAGES);

            const btnLang = document.getElementById('btn-lang');
            document.querySelectorAll('.my-dropdown-item-lang').forEach(item => {
                item.addEventListener('click', () => {
                    localStorage.setItem('locale', item.dataset.locale);
                    AlpineI18n.locale = item.dataset.locale;
                    showActiveDropdownItem(
                        btnLang,
                        item,
                        document.querySelector('.my-dropdown-item-lang.active'),
                    );
                });
            });

            showActiveDropdownItem(
                btnLang,
                document.querySelector(`[data-locale="${getUserLocale()}"]`),
                document.querySelector('.my-dropdown-item-lang.active'),
            );
        });

        document.addEventListener('alpine:init', () => {
            Alpine.data('copyLink', () => ({
                isDisabled: false,
                async copyToClipboard() {
                    // Получаем URL для копирования
                    const urlToCopy = subscriptionUrl;

                    try {
                        await navigator.clipboard.writeText(urlToCopy);
                        this.isDisabled = true;
                        setTimeout(() => {
                            this.isDisabled = false;
                        }, 3000);
                    } catch (err) {
                        console.error('Failed to copy:', err);
                        // Создаем временный input элемент для копирования
                        const tempInput = document.createElement('input');
                        tempInput.value = urlToCopy;
                        document.body.appendChild(tempInput);
                        tempInput.select();
                        document.execCommand('copy');
                        document.body.removeChild(tempInput);
                        this.isDisabled = true;
                        setTimeout(() => {
                            this.isDisabled = false;
                        }, 3000);
                    }
                },
            }));
        });

        document.addEventListener('DOMContentLoaded', () => {
            const qrCode = new QRCodeStyling({
                data: SUB_URL,
                margin: 6,
                dotsOptions: {
                    type: 'extra-rounded',
                },
                cornersSquareOptions: {
                    type: 'extra-rounded',
                },
            });
            qrCode.append(document.getElementById('qr-code'));

            const btnGuide = document.getElementById('btn-guide');
            document.querySelectorAll('.my-dropdown-item-guide').forEach(item => {
                item.addEventListener('click', () => {
                    showActiveDropdownItem(btnGuide, item);
                });
            });

            const itemInitialGuideTab =
                `.my-dropdown-item-guide[data-bs-target="${getTabIdByDevice()}"]`;
            bootstrap.Tab.getOrCreateInstance(itemInitialGuideTab).show();
            showActiveDropdownItem(
                btnGuide,
                document.querySelector(itemInitialGuideTab),
            );

            for (const [os, url] of Object.entries(SUB_URL_SCHEMES)) {
                document.getElementById(`sub-url-${os}`).href = url;
            }
        });
    </script>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
</body>

</html>